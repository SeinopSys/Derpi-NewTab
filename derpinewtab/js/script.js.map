{"version":3,"sources":["script.js"],"names":["$","getJSON","data","text","version","settings","allowedTags","metadata","undefined","filterID","$settingsWrap","$settings","everythingFilterID","$tagSettings","$body","$metaSettings","$cropSettings","$image","$imageGhost","$fadeLayer","$data","$style","$filterID","$filterIDSelect","$signinFilter","$usefilterInput","find","$showSettingsButton","_currentImageURL","html","image_url","reQuest","ajax","replace","url","success","crop","image","styles","imgElement","cachedurl","tags","downvotes","artists","append","i","el","updateMetadataSettings","window","updateTimesF","fadeIt","list","separator","list_str","split","length","list_str_len","maxDest","splice","join","empty","id","artistText","movetimeout","simplemarquee","hideFunction","cycles","space","handleHover","votestr","getElementById","comment_count","addClass","upvotes","removeClass","fadeOutData","preventDefault","created_at","uploader","cc","setBackgroundStyles","hasClass","slideUp","has","LStorage","get","Image","indexOf","page","getCachedIMGURL","width","height","error","orig_sha512_hash","each","css","src","pretty_url","on","set","sha512_hash","children","speed","Infinity","delayBetweenCycles","navigator","onLine","setTimeout","throttle","document","e","$dialog","triggerHandler","attr","toggleClass","textify","clearTimeout","your","global","$optg","createElement","userpage","$filter","this","parseInt","name","val","tagselectTimeout","setTags","possibleTags","push","$systags","type","tagselectCountdownInterval","clearInterval","tagSelectCountdown","$elem","parent","$input","stop","hide","slideDown","tagArray","setInterval","filterCond","isNaN","tag","tagsCond","del","unbindHandlers","prop","$thisInput","prev","off","tagSelectCountdownStarter","checked","filterid","trigger","$this","currFilter","test","MatadataSettings","keys","is","$inputs","noupdatekeys","nameAttr","attrIndx","filter","last","Object","stopPropagation","setTo","$select","updateCroppingSettings","remove","end","prependTo","material_select"],"mappings":"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","file":"script.js","sourcesContent":["/* global LStorage,updateMetadataSettings */\r\n$(function(){\r\n\t'use strict';\r\n\r\n\t$.getJSON('manifest.json',function(data){\r\n\t\tif (!data) return;\r\n\r\n\t\t$('#disp-version').text(' v'+data.version);\r\n\t});\r\n\r\n\t//Setting check\r\n\tlet settings = {\r\n\t\t\tallowedTags: [],\r\n\t\t\tmetadata: {},\r\n\t\t\tcrop: undefined,\r\n\t\t\tfilterID: undefined,\r\n\t\t},\r\n\t\teverythingFilterID = 56027,\r\n\t\t$settingsWrap = $('#settingsWrap'),\r\n\t\t$settings = $('#settings'),\r\n\t\t$tagSettings = $('#tag-settings'),\r\n\t\t$body = $('body'),\r\n\t\t$metaSettings = $('#metadata-settings'),\r\n\t\t$cropSettings = $('#crop-settings'),\r\n\t\t$image = $('#image'),\r\n\t\t$imageGhost = $('#image-ghost'),\r\n\t\t$fadeLayer = $('#fade-layer'),\r\n\t\t$data = $('#data'),\r\n\t\t$style = $('#style'),\r\n\t\t$filterID = $('#filter-id'),\r\n\t\t$filterIDSelect = $('#filter-id-select'),\r\n\t\t$signinFilter = $('#signin-filter'),\r\n\t\t$usefilterInput = $tagSettings.find('.usefilter input'),\r\n\t\t$showSettingsButton = $('#show-settings-button'),\r\n\t\t_currentImageURL;\r\n\r\n\t$.get('https://derpibooru.org/filters',function(data){\r\n\t\tlet $data = $(data.replace(/src=\"[^\"]+?\"/g,'')),\r\n\t\t\t$optg = {\r\n\t\t\t\tyour: $(document.createElement('optgroup')).attr('label','My Filters'),\r\n\t\t\t\tglobal: $(document.createElement('optgroup')).attr('label','Global Filters'),\r\n\t\t\t},\r\n\t\t\tuserpage = $data.find('.header__link.header__link-user').attr('href');\r\n\r\n\t\tif (!userpage){\r\n\t\t\t$signinFilter.addClass('nope').attr('title','You must be signed in on Derpibooru.org to see your own filters.');\r\n\t\t}\r\n\r\n\t\t$data.find('.filter').each(function(){\r\n\t\t\tlet $filter = $(this),\r\n\t\t\t\tname = $filter.children('h3').text(),\r\n\t\t\t\tid = parseInt($filter.children('.filter-options').find('a[href^=\"/filters/\"]').attr('href').replace(/\\D/g,''), 10);\r\n\r\n\t\t\tif (id === everythingFilterID)\r\n\t\t\t\treturn;\r\n\r\n\t\t\t$optg[$filter.find('a[href=\"'+userpage+'\"]').length ? 'your' : 'global'].append($(document.createElement('option')).attr('value',id).text(name));\r\n\t\t});\r\n\r\n\t\tif ($optg.your.children().length)\r\n\t\t\t$filterIDSelect.append($optg.your);\r\n\t\t$filterIDSelect.append($optg.global);\r\n\t\tif (settings.filterID){\r\n\t\t\tif ($filterIDSelect.find('option[value=\"'+settings.filterID+'\"]').length)\r\n\t\t\t\t$filterIDSelect.val(settings.filterID);\r\n\t\t\telse $filterIDSelect.val('???');\r\n\t\t}\r\n\t\telse $filterIDSelect.val('');\r\n\t});\r\n\r\n\t// Tag settings\r\n\t(function TagSettings(){\r\n\t\tlet possibleTags = ['safe','suggestive','questionable','explicit'],\r\n\t\t\ttagselectTimeout, tagselectCountdownInterval;\r\n\t\tif (LStorage.has('setting_allowed_tags')){\r\n\t\t\tlet setTags = LStorage.get('setting_allowed_tags').split(',');\r\n\t\t\t$.each(setTags,function(i,el){\r\n\t\t\t\tif (possibleTags.indexOf(el) > -1)\r\n\t\t\t\t\tsettings.allowedTags.push(el);\r\n\t\t\t});\r\n\t\t\tif (settings.allowedTags.length > 0) LStorage.set('setting_allowed_tags',settings.allowedTags.join(','));\r\n\t\t}\r\n\t\tif (settings.allowedTags.length === 0){\r\n\t\t\tLStorage.set('setting_allowed_tags','safe');\r\n\t\t\tsettings.allowedTags = ['safe'];\r\n\t\t}\r\n\t\tlet $systags = $settings.find('.systags');\r\n\t\t$.each(possibleTags,function(i,el){\r\n\t\t\t$systags.append(\r\n\t\t\t\t$(document.createElement('label')).append(\r\n\t\t\t\t\t$(document.createElement('input')).attr({\r\n\t\t\t\t\t\ttype: 'checkbox',\r\n\t\t\t\t\t\tname: el,\r\n\t\t\t\t\t\tchecked: settings.allowedTags.indexOf(el) > -1,\r\n\t\t\t\t\t}),\r\n\t\t\t\t\t'<span>'+el+'</span>'\r\n\t\t\t\t)\r\n\t\t\t);\r\n\t\t});\r\n\t\tfunction tagSelectCountdownStarter(){\r\n\t\t\tif (typeof tagselectTimeout === 'number'){\r\n\t\t\t\tclearInterval(tagselectTimeout);\r\n\t\t\t\t//noinspection JSUnusedAssignment\r\n\t\t\t\ttagselectTimeout = undefined;\r\n\t\t\t}\r\n\t\t\tif (typeof tagselectCountdownInterval === \"number\"){\r\n\t\t\t\tclearInterval(tagselectCountdownInterval);\r\n\t\t\t\ttagselectCountdownInterval = undefined;\r\n\t\t\t}\r\n\r\n\t\t\tlet i = 6,\r\n\t\t\t\ttagSelectCountdown = function(){\r\n\t\t\t\t\tif (--i === 0) return clearInterval(tagselectCountdownInterval);\r\n\r\n\t\t\t\t\tlet $elem = $tagSettings.find('.re-request span').text(i+' second'+(i !== 1 ? 's':'')).parent();\r\n\t\t\t\t\tif (!$elem.is(':visible')) $elem.stop().hide().slideDown();\r\n\t\t\t\t},\r\n\t\t\t\ttagArray = [];\r\n\r\n\t\t\ttagselectCountdownInterval = setInterval(tagSelectCountdown,1000);\r\n\t\t\ttagSelectCountdown();\r\n\t\t\ttagselectTimeout = setTimeout(function(){\r\n\t\t\t\t$systags.children().each(function(i,el){\r\n\t\t\t\t\tlet $input = $(el).find('input'),\r\n\t\t\t\t\t\ttag = $input.attr('name');\r\n\t\t\t\t\tif ($input.prop('checked'))\r\n\t\t\t\t\t\ttagArray.push(tag);\r\n\t\t\t\t});\r\n\r\n\t\t\t\tlet tagsCond = tagArray.length > 0,\r\n\t\t\t\t\tval = parseInt($filterID.val(), 10),\r\n\t\t\t\t\tfilterCond = !isNaN(val);\r\n\r\n\t\t\t\tif (tagsCond){\r\n\t\t\t\t\tsettings.allowedTags = tagArray;\r\n\t\t\t\t\tLStorage.set('setting_allowed_tags',tagArray.join(','));\r\n\t\t\t\t}\r\n\t\t\t\tif (filterCond){\r\n\t\t\t\t\tsettings.filterID = val;\r\n\t\t\t\t\tLStorage.set('setting_filterid',settings.filterID);\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\t$usefilterInput.prop('checked', false);\r\n\t\t\t\t\tsettings.filterID = undefined;\r\n\t\t\t\t\tLStorage.del('setting_filterid');\r\n\t\t\t\t}\r\n\t\t\t\tif (tagsCond || filterCond){\r\n\t\t\t\t\t$image.css('opacity','0');\r\n\t\t\t\t\t$imageGhost.css('opacity','0');\r\n\t\t\t\t\tunbindHandlers();\r\n\r\n\t\t\t\t\tsetTimeout(reQuest,300);\r\n\t\t\t\t}\r\n\t\t\t}, 5000);\r\n\t\t}\r\n\t\t$settings.find('.systags label span').on('click',function(e){\r\n\t\t\te.preventDefault();\r\n\r\n\t\t\tlet $thisInput = $(this).prev();\r\n\t\t\t$thisInput.prop('checked',!$thisInput.prop('checked'));\r\n\r\n\t\t\ttagSelectCountdownStarter();\r\n\t\t});\r\n\r\n\t\tif (LStorage.has('setting_filterid')){\r\n\t\t\tlet filterid = parseInt(LStorage.get('setting_filterid'), 10);\r\n\t\t\tif (isNaN(filterid))\r\n\t\t\t\tLStorage.del('setting_filterid');\r\n\t\t\telse {\r\n\t\t\t\tsettings.filterID = filterid;\r\n\t\t\t\t$usefilterInput.prop('checked', true);\r\n\t\t\t\t$filterID.val(settings.filterID).trigger('change');\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (settings.allowedTags.length === 0){\r\n\t\t\tLStorage.set('setting_allowed_tags','safe');\r\n\t\t\tsettings.allowedTags = ['safe'];\r\n\t\t}\r\n\t\t$usefilterInput.on('click',function(){\r\n\t\t\tlet $this = $(this),\r\n\t\t\t\tchecked = $this.prop('checked');\r\n\r\n\t\t\tif (!checked)\r\n\t\t\t\t$filterID.val('').trigger('change');\r\n\t\t});\r\n\t\t$filterIDSelect.on('change keyup',function(){\r\n\t\t\tlet val = $filterIDSelect.val();\r\n\t\t\tif (val && /^\\d+$/.test(val)){\r\n\t\t\t\tif ($usefilterInput.prop('checked') !== true)\r\n\t\t\t\t\t$usefilterInput.prop('checked', true);\r\n\t\t\t\t$filterID.val(val).trigger('change');\r\n\t\t\t}\r\n\t\t});\r\n\t\t$filterID.on('change keyup',function(){\r\n\t\t\tif ($filterIDSelect.find('option[value=\"'+$filterID.val()+'\"]').length)\r\n\t\t\t\t$filterIDSelect.val($filterID.val());\r\n\t\t\telse $filterIDSelect.val('???');\r\n\t\t\tif (!$filterID.is(':valid'))\r\n\t\t\t\treturn;\r\n\r\n\t\t\tlet currFilter = settings.filterID ? settings.filterID : '';\r\n\t\t\tif ($filterID.val() !== currFilter)\r\n\t\t\t\ttagSelectCountdownStarter();\r\n\t\t});\r\n\t})();\r\n\t// Metadata settings\r\n\t(function MatadataSettings(){\r\n\t\tlet $inputs = $metaSettings.find('.switch input'), keys;\r\n\t\t$inputs.each(function(){\r\n\t\t\tsettings.metadata[this.name] = false;\r\n\t\t});\r\n\t\t\r\n\t\tif (!LStorage.has('setting_metadata')){\r\n\t\t\tkeys = Object.keys(settings.metadata);\r\n\t\t\tLStorage.set('setting_metadata',keys.join(','));\r\n\t\t}\r\n\t\telse {\r\n\t\t\tkeys = LStorage.get('setting_metadata');\r\n\t\t\tif (keys.length === 0) keys = [];\r\n\t\t\telse keys = keys.split(',');\r\n\t\t}\r\n\t\t\r\n\t\t$.each(keys,function(i,el){\r\n\t\t\tif (typeof settings.metadata[el] !== 'undefined')\r\n\t\t\t\tsettings.metadata[el] = true;\r\n\t\t\telse delete keys[i];\r\n\t\t});\r\n\t\t\r\n\t\tfunction updateMetadataSettings(noupdatekeys){\r\n\t\t\tif (noupdatekeys !== true) LStorage.set('setting_metadata',keys.join(','));\r\n\t\t\t\r\n\t\t\t$inputs.each(function(){\r\n\t\t\t\t$('#data .'+this.name.substring(4))[keys.indexOf(this.name) > -1?'show':'hide']();\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\t$data.find('p span').filter(':visible').addClass('visible').last().removeClass('visible');\r\n\t\t}\r\n\t\twindow.updateMetadataSettings = function(){ updateMetadataSettings() };\r\n\t\t\r\n\t\tupdateMetadataSettings();\r\n\t\t\r\n\t\t$inputs.each(function(){\r\n\t\t\tthis.checked = !!settings.metadata[this.name];\r\n\t\t\t$(this).prop('checked',this.checked);\r\n\t\t});\r\n\t\t$metaSettings.find('.switch input').on('click',function(e){\r\n\t\t\te.stopPropagation();\r\n\t\t\t\r\n\t\t\tlet nameAttr = this.name,\r\n\t\t\t\tattrIndx = keys.indexOf(nameAttr);\r\n\t\t\t\r\n\t\t\tif (attrIndx === -1) keys.push(nameAttr);\r\n\t\t\telse keys.splice(attrIndx, 1);\r\n\t\t\t\r\n\t\t\tupdateMetadataSettings();\r\n\t\t});\r\n\t})();\r\n\t// Image cropping settings\r\n\t(function ImageCroppingSettings(){\r\n\t\tlet $select = $cropSettings.find('.input-field select');\r\n\r\n\t\tif (!LStorage.has('setting_crop')){\r\n\t\t\tsettings.crop = 'contain';\r\n\t\t\tLStorage.set('setting_crop', settings.crop);\r\n\t\t}\r\n\t\telse settings.crop = LStorage.get('setting_crop');\r\n\r\n\t\tfunction updateCroppingSettings(){\r\n\t\t\tlet setTo = settings.crop;\r\n\t\t\tif (['contain','cover','100% 100%'].indexOf(setTo) === -1)\r\n\t\t\t\tsetTo = 'cover';\r\n\r\n\t\t\tLStorage.set('setting_crop', setTo);\r\n\t\t\tsettings.crop = setTo;\r\n\t\t\t$select.val(setTo);\r\n\t\t\tsetBackgroundStyles();\r\n\t\t}\r\n\t\twindow.updateCroppingSettings = function(){ updateCroppingSettings() };\r\n\r\n\t\tupdateCroppingSettings();\r\n\r\n\t\t$select.on('change',function(){\r\n\t\t\tsettings.crop = $select.val();\r\n\r\n\t\t\tupdateCroppingSettings();\r\n\t\t});\r\n\t})();\r\n\r\n\t// Background size updater\r\n\tfunction setBackgroundStyles(image_url){\r\n\t\tif (typeof image_url === 'string')\r\n\t\t\t_currentImageURL = image_url;\r\n\t\telse if (typeof _currentImageURL !== 'string')\r\n\t\t\treturn;\r\n\t\tlet url = _currentImageURL.replace(/\"/g, '%22'),\r\n\t\t\tstyles = '#image{background-image:url(\"'+url+'\");background-size:'+settings.crop+'}';\r\n\t\tif (settings.crop === 'contain'){\r\n\t\t\t$imageGhost.css('opacity','');\r\n\t\t\tstyles += '#image-ghost{display:block;background-image:url(\"'+url+'\")}';\r\n\t\t}\r\n\r\n\t\t$style.html(styles);\r\n\t}\r\n\r\n\t// Begin site\r\n\tif (LStorage.has(\"image_data\") && LStorage.has(\"image_hash\")){\r\n\t\tsetBackgroundStyles(LStorage.get(\"image_data\"));\r\n\t\t$image.css('opacity','1').attr('data-hash',LStorage.get('image_hash'));\r\n\t}\r\n\r\n\treQuest();\r\n\r\n\t$data.html('<h1>Requesting metadata...</h1>').css('opacity', 1);\r\n\tfunction reQuest(page){\r\n\t\t$body.removeClass('notloading');\r\n\t\t$tagSettings.find('.re-request:visible').slideUp();\r\n\t\t\r\n\t\t$.ajax({\r\n\t\t\turl: 'https://trixiebooru.org/search.json'+\r\n\t\t\t        '?filter_id='+(settings.filterID||everythingFilterID)+\r\n\t\t\t        '&q=wallpaper+%26%26+('+settings.allowedTags.join('+%7C%7C+')+')+%26%26+-equestria+girls'+\r\n\t\t\t        (typeof page === 'number' ? '&page='+page : ''),\r\n\t\t\tsuccess: function(data){\r\n\t\t\t\tlet image, imgElement = new Image(), i = -1;\r\n\t\t\t\t\r\n\t\t\t\tdata = data.search;\r\n\t\t\t\t\r\n\t\t\t\tif (data.length === 0) {\r\n\t\t\t\t\tfadeIt();\r\n\t\t\t\t\t$body.addClass('notloading');\r\n\t\t\t\t\t$data.html('<h1>Search returned no results.</h1>' + (settings.allowedTags.indexOf('safe') === -1 ? '<p>Try enabling the safe system tag.</p>' : ''));\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\twhile (++i < data.length-1){\r\n\t\t\t\t\t// Optimal size images are above 720p and below 4096px in width & height, since larger images will make the browser lag\r\n\t\t\t\t\tif (data[i].width >= 1280 && data[i].height >= 720 && data[i].width <= 4096 && data[i].height <= 4096){\r\n\t\t\t\t\t\timage = data[i];\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t$body.addClass('notloading');\r\n\t\t\t\t\r\n\t\t\t\tif (typeof image === 'undefined')\r\n\t\t\t\t\treturn reQuest(typeof page === 'number' ? page+1 : 2);\r\n\t\t\t\t\r\n\t\t\t\tif (!LStorage.has(\"image_hash\") || LStorage.get(\"image_hash\") !== image.orig_sha512_hash){\r\n\t\t\t\t\tif (typeof page === 'undefined')\r\n\t\t\t\t\t\t$data.html('<h1>Searching for new image...</h1>').css('opacity','1');\r\n\t\t\t\t\t\r\n\t\t\t\t\timgElement.src = 'https:'+image.pretty_url;\r\n\t\t\t\t\t$(imgElement).on('load',function(){\r\n\t\t\t\t\t\t// Save image into localStorage\r\n\t\t\t\t\t\tLStorage.set(\"image_data\", imgElement.src);\r\n\t\t\t\t\t\tLStorage.set(\"image_hash\", image.sha512_hash);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tmetadata(image, imgElement.src);\r\n\t\t\t\t\t}).on('error', function(){\r\n\t\t\t\t\t\tif (!image.is_rendered)\r\n\t\t\t\t\t\t\t$data.html('<h1>Image has not been rendered yet</h1><p>Try reloading in a minute or so</p>');\r\n\t\t\t\t\t\telse $data.html('<h1>Image failed to load</h1><p>Either the image is no longer available or the extension is broken</p>');\r\n\t\t\t\t\t\tfadeIt();\r\n\t\t\t\t\t\treturn reQuest(typeof page === 'number' ? page+1 : 2);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\telse metadata(image, getCachedIMGURL());\r\n\t\t\t},\r\n\t\t\terror: function(){\r\n\t\t\t\t$body.addClass('notloading');\r\n\t\t\t\t$data.html('<h1>There was an error while fetching the image data</h1><p>'+(navigator.onLine ? 'Derpibooru may be down for maintenance, try again later.' : 'You are not conected to the Internet.')+'</p>');\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\tfunction metadata(image,cachedurl){\r\n\t\t\tlet tags = image.tags.split(', '),\r\n\t\t\t\tartists = [];\r\n\t\t\t\r\n\t\t\t$.each(tags,function(i,el){\r\n\t\t\t\tif (el.indexOf('artist:') === 0)\r\n\t\t\t\t\tartists.push(el.substring(7));\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tlet artistText = artists.length ? 'By '+textify(artists) : 'Artist unknown';\r\n\t\t\t\r\n\t\t\t$data.empty().append('<h1><a href=\"https://derpibooru.org/'+image.id+'\">'+artistText+'</a></h1>');\r\n\r\n\t\t\t$data.children('h1').simplemarquee({\r\n\t\t\t    speed: 25,\r\n\t\t\t    cycles: Infinity,\r\n\t\t\t    space: 25,\r\n\t\t\t    handleHover: false,\r\n\t\t\t    delayBetweenCycles: 0,\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tlet votestr = '', cc = image.comment_count;\r\n\t\t\tif (image.upvotes + image.downvotes === 0) votestr = 'no votes';\r\n\t\t\telse {\r\n\t\t\t\tif (image.upvotes > 0){\r\n\t\t\t\t\tvotestr += image.upvotes+' upvote';\r\n\t\t\t\t\tif (image.upvotes > 1) votestr += 's';\r\n\t\t\t\t\tif (image.downvotes > 0){\r\n\t\t\t\t\t\tvotestr += ' and '+image.downvotes+' downvote';\r\n\t\t\t\t\t\tif (image.downvotes > 1) votestr += 's';\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse if (image.downvotes > 0) votestr += image.downvotes+' downvote'+(image.downvotes>1?'s':'');\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t$data.append(\r\n\t\t\t\t`<p>\r\n\t\t\t\t\t<span class=\"uploadtime visible\">uploaded <time datetime=\"${image.created_at}\"></time> by ${image.uploader}</span>\r\n\t\t\t\t\t<span class=\"votes\">${votestr}</span>\r\n\t\t\t\t\t<span class=\"comments\">${cc>0?cc:'no'} comment${cc!==1?'s':''}</span>\r\n\t\t\t\t</p>`\r\n\t\t\t);\r\n\t\t\tupdateMetadataSettings();\r\n\t\t\twindow.updateTimesF();\r\n\r\n\t\t\tsetBackgroundStyles(cachedurl);\r\n\t\t\tfadeIt();\r\n\t\t\tfadeOutData();\r\n\t\t}\r\n\t\t\r\n\t\tlet movetimeout = false,\r\n\t\t\thideFunction = function(){\r\n\t\t\t\tif (!$fadeLayer.children('.hover').length)\r\n\t\t\t\t\t$fadeLayer.css('opacity', 0);\r\n\t\t\t\telse movetimeout = setTimeout(hideFunction, 2000);\r\n\t\t\t};\r\n\t\tfunction fadeIt(){\r\n\t\t\t$image.css('opacity', 1);\r\n\r\n\t\t\t$body.on('mousemove',$.throttle(100,function(){\r\n\t\t\t\tif (document.getElementById('dialog'))\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t$fadeLayer.css('opacity','1');\r\n\t\t\t\t$fadeLayer.on('mouseenter','> *',function(){\r\n\t\t\t\t\t$(this).addClass('hover');\r\n\t\t\t\t}).on('mouseleave','> *',function(){\r\n\t\t\t\t\t$(this).removeClass('hover');\r\n\t\t\t\t});\r\n\t\t\t\tfadeOutData();\r\n\t\t\t}));\r\n\t\t\t$body.triggerHandler('mousemove');\r\n\t\t\t$showSettingsButton.attr('disabled', false).on('click',function(e){\r\n\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\t$settingsWrap.toggleClass('open');\r\n\t\t\t\t$body.triggerHandler('mousemove');\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\tfunction fadeOutData(){\r\n\t\t\tif (movetimeout !== false){\r\n\t\t\t\tclearTimeout(movetimeout);\r\n\t\t\t\t//noinspection JSUnusedAssignment\r\n\t\t\t\tmovetimeout = false;\r\n\t\t\t}\r\n\t\t\tif (!$settingsWrap.hasClass('open'))\r\n\t\t\t\tmovetimeout = setTimeout(hideFunction, 2000);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction unbindHandlers(){\r\n\t\t$body.off('mousemove');\r\n\t\t$showSettingsButton.off('click').attr('disabled', true);\r\n\t\t$settingsWrap.removeClass('open');\r\n\t}\r\n\t\r\n\tfunction getCachedIMGURL(){\r\n\t\treturn LStorage.get(\"image_data\");\r\n\t}\r\n\r\n\t// First run dialog\r\n\tif (!LStorage.has('firstrun')){\r\n\t\t$(document.createElement('div'))\r\n\t\t\t.attr('id','dialog')\r\n\t\t\t.html('<div id=\"dialog-inner\"><h1>Welcome to Derpi-New Tab</h1><p>To access the settings click the <i class=\"material-icons\">menu</i> icon in the bottom left of the browser window.<br><span style=\"color:rgba(255,255,255,.5)\">(this message is only displayed once)</span></p></div>')\r\n\t\t\t.children()\r\n\t\t\t.append($(document.createElement('button')).text('Got it').on('click',function(e){\r\n\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\tLStorage.set('firstrun',1);\r\n\t\t\t\tlet $dialog = $('#dialog').addClass('gtfo');\r\n\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t$dialog.remove();\r\n\t\t\t\t}, 550);\r\n\t\t\t}))\r\n\t\t\t.end()\r\n\t\t\t.prependTo($body);\r\n\t}\r\n\r\n    $cropSettings.find('select').material_select();\r\n\t\t\r\n\t// List textifier\r\n\tfunction textify(list, append, separator){\r\n\t\tif (typeof append === 'undefined') append = 'and';\r\n\t\tif (typeof separator === 'undefined') separator = ',';\r\n\r\n\t\tlet list_str;\r\n\t\t\r\n\t\tif (typeof list === 'string') list = list.split(separator);\r\n\t\tif (list.length > 1){\r\n\t\t\tlist_str = list;\r\n\t\t\tlet list_str_len = list_str.length,\r\n\t\t\t\tmaxDest = list_str_len-3,\r\n\t\t\t\ti = 0;\r\n\t\t\tlist_str.splice(list_str_len-1,0,append);\r\n\t\t\twhile (i <= maxDest){\r\n\t\t\t\tif (i === list_str_len-1)\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\tlist_str[i] += ',';\r\n\t\t\t\ti++;\r\n\t\t\t}\r\n\t\t\tlist_str = list_str.join(' ');\r\n\t\t}\r\n\t\telse list_str = list[0];\r\n\t\treturn list_str;\r\n\t}\r\n});\r\n"]}